Metadata-Version: 2.4
Name: MAnormFast
Version: 0.1.0
Summary: MAnorm Fast - A robust model for quantitative comparison of ChIP-Seq data sets
Home-page: https://github.com/semal/MAnormFast
Author: Semal
Author-email: gzhsss2@gmail.com
License: GNU General Public License v3 (GPLv3)
Project-URL: Bug Reports, https://github.com/semal/MAnormFast/issues
Project-URL: Source, https://github.com/semal/MAnormFast
Project-URL: Documentation, https://github.com/semal/MAnormFast/blob/main/README.md
Keywords: bioinformatics,ChIP-Seq,genomics,peak analysis,normalization
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Science/Research
Classifier: License :: OSI Approved :: GNU General Public License v3 (GPLv3)
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Scientific/Engineering :: Bio-Informatics
Classifier: Operating System :: OS Independent
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: numpy>=1.21.0
Requires-Dist: matplotlib>=3.5.0
Requires-Dist: pandas>=1.3.0
Requires-Dist: scipy>=1.7.0
Requires-Dist: statsmodels>=0.13.0
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: keywords
Dynamic: license
Dynamic: project-url
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# MAnormFast

[![Python Version](https://img.shields.io/badge/python-3.10%2B-blue.svg)](https://python.org)
[![License](https://img.shields.io/badge/license-GPL--3.0-green.svg)](LICENSE)

MAnormFast is a robust and efficient tool for quantitative comparison of ChIP-Seq data sets. It provides a simple and effective method for analyzing transcription factor binding sites and epigenetic modifications across different cell types and conditions.

## Introduction

ChIP-Seq is widely used to characterize genome-wide binding patterns of transcription factors and other chromatin-associated proteins. Although comparison of ChIP-Seq data sets is critical for understanding cell type-dependent and cell state-specific binding, and thus the study of cell-specific gene regulation, few quantitative approaches have been developed. 

MAnormFast presents a simple and effective method for quantitative comparison of ChIP-Seq data sets describing transcription factor binding sites and epigenetic modifications. The quantitative binding differences inferred by MAnormFast showed strong correlation with both the changes in expression of target genes and the binding of cell type-specific regulators.

## Installation

### Install from PyPI (Recommended)

```bash
pip install MAnormFast
```

### Install from Source

```bash
git clone https://github.com/semal/MAnormFast.git
cd MAnormFast
pip install .
```

### Development Installation

```bash
git clone https://github.com/semal/MAnormFast.git
cd MAnormFast
pip install -e .
```

## Requirements

- Python >= 3.10
- numpy >= 1.21.0
- matplotlib >= 3.5.0
- pandas >= 1.3.0
- scipy >= 1.7.0
- statsmodels >= 0.13.0

## Quick Start

After installation, you can use MAnormFast from the command line:

```bash
MAnormFast --p1 peak1.bed --r1 read1.bed --p2 peak2.bed --r2 read2.bed -o output_folder
```

## Usage

### Basic Command

```bash
MAnormFast --p1 <peak_file_1> --r1 <read_file_1> --p2 <peak_file_2> --r2 <read_file_2> -o <output_folder>
```

### Input Files

MAnormFast requires five input arguments:
- `--p1`: Peak file for sample 1
- `--r1`: Read file for sample 1  
- `--p2`: Peak file for sample 2
- `--r2`: Read file for sample 2
- `-o`: Output folder name

**Note:** Peak files support BED format and MACS output XLS format. The first three columns should be 'chr start end'. If there is a summit column, it should be placed in the fourth column.

### Command Line Options

| Option | Description | Default |
|--------|-------------|---------|
| `--p1` | Numerator peaks file path | Required |
| `--p2` | Denominator peaks file path | Required |
| `--r1` | Numerator reads file path | Required |
| `--r2` | Denominator reads file path | Required |
| `-o` | Output folder name | Required |
| `--s1` | Read shift size of sample 1 | 100 |
| `--s2` | Read shift size of sample 2 | 100 |
| `-e` | Extension size of peak | 1000 |
| `-n` | Number of random permutations | 5 |
| `-d` | Summit to summit distance cutoff | extension/2 |
| `-p` | P-value cutoff for biased peaks | 0.01 |
| `-m` | M-value cutoff for biased peaks | 1.0 |
| `-u` | M-value cutoff for unbiased peaks | 1.0 |
| `-s` | Output without merging peaks | False |
| `-v` | Use overlap-dependent mode | False |

### Example

```bash
# Basic usage
MAnormFast --p1 sample1_peaks.bed --r1 sample1_reads.bed \
           --p2 sample2_peaks.bed --r2 sample2_reads.bed \
           -o comparison_results

# With custom parameters
MAnormFast --p1 sample1_peaks.bed --r1 sample1_reads.bed \
           --p2 sample2_peaks.bed --r2 sample2_reads.bed \
           -o comparison_results -e 500 -n 10 -p 0.05
```

## Peak File Format Support

MAnormFast supports multiple peak file formats:

### Standard BED Format
```
chr1    2345    4345
chr1    3456    5456
chr2    6543    8543 
```

### 4-Column BED Format (with summit)
```
chr1    2345    4345    254
chr1    3456    5456    127
chr2    6543    8543    302
```

### MACS Output Format
```
chr     start   end     length  summit  tags    -10*log10(pvalue)       fold_enrichment FDR(%)
chr7    97911064        97917104        6041    368     648     3233.06 22.57   0.0
chr11   35159640        35167695        8056    1358    1066    3233.06 21.83   0.0
```

## Output

MAnormFast generates several output files and directories:

- `*_all_peak_MAvalues.xls`: Main results file with M-A values for all peaks
- `output_figures/`: Directory containing visualization plots
- `output_filters/`: Directory containing filtered peak sets (biased/unbiased)
- `output_wig_files/`: Directory containing wiggle files for genome browsers

## Python API

You can also use MAnormFast programmatically:

```python
from MAnormFast import command
import sys

# Set command line arguments
sys.argv = ['MAnormFast', '--p1', 'peak1.bed', '--r1', 'read1.bed', 
            '--p2', 'peak2.bed', '--r2', 'read2.bed', '-o', 'output']

# Run analysis
command()
```

## Citation

If you use MAnormFast in your research, please cite:

[Shao Z, Zhang Y, Yuan GC, Orkin SH, Waxman DJ. (2012) MAnorm: a robust model for quantitative comparison of ChIP-Seq data sets. Genome Biol. Mar 16;13(3):R16.](https://genomebiology.biomedcentral.com/articles/10.1186/gb-2012-13-3-r16)

## License

This project is licensed under the GNU General Public License v3.0 - see the [LICENSE](LICENSE) file for details.

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## Support

If you encounter any issues or have questions, please:

1. Check the [Issues](https://github.com/semal/MAnormFast/issues) page
2. Create a new issue if your problem isn't already reported
3. Provide detailed information about your environment and the problem

## Changelog

### Version 0.1.0
- Initial release with pip installation support
- Improved command-line interface
- Enhanced documentation
- Python 3.10+ compatibility

